################################################################################
#
# Drug Screen Data Example Configuration
#
################################################################################

# General
name: ac50
index_col: cell_line
xid: sample_id

#type: dose_response_dataframe
#role: response
#sample_id : cell_line
#compound_id : drug_id
#response_var: ac50

#
# Path to drug screen data
#
path: 'tests/data/response/drug_curves.csv'

# 
# Drug screen data processing pipeline
#
pipeline:
  #- filter_rows_col_ne:
  #    value: 'KMS20_JCRB'
  - filter_rows_index_not_in:
      indices: ['KMS20_JCRB']
  - filter_rows_col_not_na:
      name: 'filter_missing_ac50'
      field: 'ac50'
  - filter_rows_col_gt:
      name: 'filter_curve_slope'
      field: 'curve_slope'
      value: 0
  #- filter_rows_group_func_ge:
  #    name: 'filter_min_curves_remaining'
  #    group: 'drug_id'
  #    size: 3 
  - filter_rows_group_func_ge:
      name: 'filter_min_variability'
      group: 'drug_id'
      field: 'ac50'
      stat: 'mad'
      quantile: 0.95

  #- branch:
  #  - dim_reduce_pca:
  #     target: 'rows'
  #     num_pcs: 5
  #  - compute_cor_mat:
  #     target: columns
  #     method: 'pearson'
  #     id: 'ac50_sample_pca_cormat'
  #     zero_diag: true
